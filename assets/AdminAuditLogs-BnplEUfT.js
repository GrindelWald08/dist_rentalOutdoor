import{c as S,r as j,j as e}from"./index-Dp5V46W7.js";import{u as w,B as x,o as R}from"./useAdmin-BxB2P_tw.js";import{A as _,S as L}from"./AdminLayout-3U3SLMcL.js";import{B as p}from"./badge-BgO9vWjm.js";import{T as P,a as M,b as o,c as i,d as H,e as d}from"./table-DyyXYKSB.js";import{S as g,a as v,b,c as N,d as s}from"./select-DdEMORC5.js";import{D as U,a as B,b as O,c as I}from"./dialog-COFoAsB1.js";import{I as f}from"./input-Ccy3rJvP.js";import{L as r}from"./label-DcpSdAy0.js";import{E as F}from"./eye-Cn8to-46.js";import{f as y,i as T}from"./id-8SRIAgvI.js";import"./package-kCUf3xtc.js";import"./index-BdQq_4o_.js";import"./Combination-D7J0VMFL.js";import"./index-C1YjNfLO.js";import"./chevron-down-DaxDHgOO.js";import"./index-CU77mCJl.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=S("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=S("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),D={CREATE:"bg-green-500/10 text-green-600 border-green-500/20",UPDATE:"bg-blue-500/10 text-blue-600 border-blue-500/20",DELETE:"bg-red-500/10 text-red-600 border-red-500/20",APPROVE:"bg-emerald-500/10 text-emerald-600 border-emerald-500/20",REJECT:"bg-orange-500/10 text-orange-600 border-orange-500/20",STATUS_CHANGE:"bg-purple-500/10 text-purple-600 border-purple-500/20",RETURN_PROCESS:"bg-cyan-500/10 text-cyan-600 border-cyan-500/20"},E={products:"Produk",orders:"Pesanan",testimonials:"Testimoni",categories:"Kategori",packages:"Paket",user_roles:"Role User"},ne=()=>{const[l,c]=j.useState({action:"",tableName:"",startDate:"",endDate:""}),[t,m]=j.useState(null),{data:h=[],isLoading:k,refetch:A}=w({queryKey:["auditLogs",l],queryFn:()=>R(100,0,{action:l.action||void 0,tableName:l.tableName||void 0,startDate:l.startDate||void 0,endDate:l.endDate||void 0})}),C=()=>{c({action:"",tableName:"",startDate:"",endDate:""})},u=a=>a?JSON.stringify(a,null,2):"-";return e.jsx(_,{title:"Audit Log",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(L,{className:"h-5 w-5"}),e.jsx("span",{children:"Catatan aktivitas admin untuk keamanan dan audit"})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 items-end p-4 bg-muted/50 rounded-lg",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Aksi"}),e.jsxs(g,{value:l.action,onValueChange:a=>c(n=>({...n,action:a})),children:[e.jsx(v,{className:"w-[150px]",children:e.jsx(b,{placeholder:"Semua Aksi"})}),e.jsxs(N,{children:[e.jsx(s,{value:"",children:"Semua Aksi"}),e.jsx(s,{value:"CREATE",children:"Create"}),e.jsx(s,{value:"UPDATE",children:"Update"}),e.jsx(s,{value:"DELETE",children:"Delete"}),e.jsx(s,{value:"APPROVE",children:"Approve"}),e.jsx(s,{value:"REJECT",children:"Reject"}),e.jsx(s,{value:"STATUS_CHANGE",children:"Status Change"}),e.jsx(s,{value:"RETURN_PROCESS",children:"Return Process"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Tabel"}),e.jsxs(g,{value:l.tableName,onValueChange:a=>c(n=>({...n,tableName:a})),children:[e.jsx(v,{className:"w-[150px]",children:e.jsx(b,{placeholder:"Semua Tabel"})}),e.jsxs(N,{children:[e.jsx(s,{value:"",children:"Semua Tabel"}),e.jsx(s,{value:"products",children:"Produk"}),e.jsx(s,{value:"orders",children:"Pesanan"}),e.jsx(s,{value:"testimonials",children:"Testimoni"}),e.jsx(s,{value:"categories",children:"Kategori"}),e.jsx(s,{value:"packages",children:"Paket"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Dari Tanggal"}),e.jsx(f,{type:"date",value:l.startDate,onChange:a=>c(n=>({...n,startDate:a.target.value})),className:"w-[150px]"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Sampai Tanggal"}),e.jsx(f,{type:"date",value:l.endDate,onChange:a=>c(n=>({...n,endDate:a.target.value})),className:"w-[150px]"})]}),e.jsxs(x,{variant:"outline",onClick:C,children:[e.jsx(V,{className:"h-4 w-4 mr-2"}),"Reset"]}),e.jsxs(x,{variant:"outline",onClick:()=>A(),children:[e.jsx(q,{className:"h-4 w-4 mr-2"}),"Refresh"]})]}),e.jsx("div",{className:"border rounded-lg overflow-hidden",children:e.jsxs(P,{children:[e.jsx(M,{children:e.jsxs(o,{children:[e.jsx(i,{children:"Waktu"}),e.jsx(i,{children:"Admin"}),e.jsx(i,{children:"Aksi"}),e.jsx(i,{children:"Tabel"}),e.jsx(i,{children:"Record ID"}),e.jsx(i,{children:"Detail"})]})}),e.jsx(H,{children:k?e.jsx(o,{children:e.jsx(d,{colSpan:6,className:"text-center py-8",children:"Memuat data..."})}):h.length===0?e.jsx(o,{children:e.jsx(d,{colSpan:6,className:"text-center py-8 text-muted-foreground",children:"Belum ada aktivitas tercatat"})}):h.map(a=>e.jsxs(o,{children:[e.jsx(d,{className:"whitespace-nowrap",children:y(new Date(a.created_at),"dd MMM yyyy HH:mm",{locale:T})}),e.jsx(d,{children:e.jsx("span",{className:"text-sm",children:a.user_email||"Unknown"})}),e.jsx(d,{children:e.jsx(p,{variant:"outline",className:D[a.action]||"",children:a.action})}),e.jsx(d,{children:E[a.table_name]||a.table_name}),e.jsx(d,{children:e.jsx("code",{className:"text-xs bg-muted px-2 py-1 rounded",children:a.record_id?a.record_id.slice(0,8)+"...":"-"})}),e.jsx(d,{children:e.jsx(x,{variant:"ghost",size:"sm",onClick:()=>m(a),children:e.jsx(F,{className:"h-4 w-4"})})})]},a.id))})]})}),e.jsx(U,{open:!!t,onOpenChange:()=>m(null),children:e.jsxs(B,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsx(O,{children:e.jsx(I,{children:"Detail Audit Log"})}),t&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(r,{className:"text-muted-foreground",children:"Waktu"}),e.jsx("p",{children:y(new Date(t.created_at),"dd MMMM yyyy HH:mm:ss",{locale:T})})]}),e.jsxs("div",{children:[e.jsx(r,{className:"text-muted-foreground",children:"Admin"}),e.jsx("p",{children:t.user_email||"Unknown"})]}),e.jsxs("div",{children:[e.jsx(r,{className:"text-muted-foreground",children:"Aksi"}),e.jsx(p,{variant:"outline",className:D[t.action]||"",children:t.action})]}),e.jsxs("div",{children:[e.jsx(r,{className:"text-muted-foreground",children:"Tabel"}),e.jsx("p",{children:E[t.table_name]||t.table_name})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(r,{className:"text-muted-foreground",children:"Record ID"}),e.jsx("code",{className:"block text-sm bg-muted px-2 py-1 rounded mt-1",children:t.record_id||"-"})]})]}),t.old_data&&e.jsxs("div",{children:[e.jsx(r,{className:"text-muted-foreground",children:"Data Lama"}),e.jsx("pre",{className:"text-xs bg-muted p-3 rounded mt-1 overflow-x-auto",children:u(t.old_data)})]}),t.new_data&&e.jsxs("div",{children:[e.jsx(r,{className:"text-muted-foreground",children:"Data Baru"}),e.jsx("pre",{className:"text-xs bg-muted p-3 rounded mt-1 overflow-x-auto",children:u(t.new_data)})]})]})]})})]})})};export{ne as default};
